<!DOCTYPE html>
<!--
    Basically Basic Jekyll Theme 1.4.1
    Copyright 2017-2018 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/jekyll-basically-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
     <meta name="description" content="  ">
<title>
   
       How To Make : A Machine Learning Based Sudoku Solving Robot
   
</title>

<meta itemprop="description" name="description" content="How to make a machine learning based sudoku solver robot using a Raspberry Pi from scratch." />
 <meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="How To Make : A Machine Learning Based Sudoku Solving Robot">
<meta property="og:url" content="http://localhost:4000/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/">
<meta property="og:image" content="http://localhost:4000/blog/img/sudo/sudo1.jpg" />
<meta property="og:site_name" content="SPARKLERS : We Are The Makers">
<meta property="article:publisher" content="http://www.facebook.com/sparklers2018" />
<meta property="article:author" content="https://www.facebook.com/profile.php?id=100009569555607" />
<meta property="article:published_time" content="2019-06-30 14:25:52 -0500" />
<meta property="og:description" content="How to make a machine learning based sudoku solver robot using a Raspberry Pi from scratch.">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@vdaubry">
<meta name="twitter:creator" content="@vdaubry">

  <meta name="twitter:title" content="How To Make : A Machine Learning Based Sudoku Solving Robot">


  <meta name="twitter:url" content="http://localhost:4000/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/">


  <meta name="twitter:description" content="How to make a machine learning based sudoku solver robot using a Raspberry Pi from scratch.">



  
    
    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>How To Make : A Machine Learning Based Sudoku Solving Robot | SPARKLERS:We Are The Makers</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="How To Make : A Machine Learning Based Sudoku Solving Robot" />
<meta name="author" content="Arijit Das" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to make a machine learning based sudoku solver robot using a Raspberry Pi from scratch." />
<meta property="og:description" content="How to make a machine learning based sudoku solver robot using a Raspberry Pi from scratch." />
<link rel="canonical" href="http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/" />
<meta property="og:url" content="http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/" />
<meta property="og:site_name" content="SPARKLERS:We Are The Makers" />
<meta property="og:image" content="http://localhost:4000/blog/img/sudo/sudo1.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-06-30T00:00:00+05:30" />
<script type="application/ld+json">
{"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/blog/assets/icons/logo.jpg"},"name":"Arijit Das"},"@type":"BlogPosting","url":"http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/","headline":"How To Make : A Machine Learning Based Sudoku Solving Robot","dateModified":"2019-07-01T00:55:52+05:30","datePublished":"2019-06-30T00:00:00+05:30","author":{"@type":"Person","name":"Arijit Das"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/"},"image":"http://localhost:4000/blog/img/sudo/sudo1.jpg","description":"How to make a machine learning based sudoku solver robot using a Raspberry Pi from scratch.","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/blog/assets/stylesheets/main.css">
  <link rel="shortcut icon" type="image/png" href="/blog/assets/icons/favicon.ico">
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:400,400i,600,600i">
  

  
    
    <link rel="alternate" type="application/atom+xml" title="SPARKLERS:We Are The Makers" href="/blog/atom.xml">
  
</head>


  <body class="layout--post how-to-make-a-machine-learning-based-sudoku-solving-robot">

    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>


    <div class="sidebar-toggle-wrapper">
      
        <button class="search-toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <title>Search</title>
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
      

      <button class="toggle navicon-button larr" type="button">
        <span class="toggle-inner">
          <span class="sidebar-toggle-label visually-hidden">Menu</span>
          <span class="navicon"></span>
        </span>
      </button>
    </div>

    <div id="sidebar" class="sidebar">
      <div class="inner">
        <nav id="primary-nav" class="site-nav" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation">
  <ul id="menu-main-navigation" class="menu">
    <!-- Home link -->
    <li class="menu-item">
      <a href="/blog/" itemprop="url">
        <span itemprop="name">Home</span>
      </a>
    </li>

    <!-- site.pages links -->
    
    

    
      
      
        <li class="menu-item">
          <a href="/blog/about/" itemprop="url">
            <span itemprop="name">About</span>
          </a>
        </li>
      
    
      
      
        <li class="menu-item">
          <a href="/blog/projects/" itemprop="url">
            <span itemprop="name">Projects</span>
          </a>
        </li>
      
    
      
      
        <li class="menu-item">
          <a href="/blog/posts/" itemprop="url">
            <span itemprop="name">Post Archive</span>
          </a>
        </li>
      
    
      
      
        <li class="menu-item">
          <a href="/blog/team/" itemprop="url">
            <span itemprop="name">Team</span>
          </a>
        </li>
      
    
  </ul>
</nav>

        <ul class="contact-list">
  
    <li>
      <a href="mailto:arijit1080@gmail.com">
        <span class="icon icon--email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="313.1 3.7 16 16"><path d="M318.5 8.9c0-.2.2-.4.4-.4h4.5c.2 0 .4.2.4.4s-.2.4-.4.4h-4.5c-.3 0-.4-.2-.4-.4zm.4 2.1h4.5c.2 0 .4-.2.4-.4s-.2-.4-.4-.4h-4.5c-.2 0-.4.2-.4.4s.1.4.4.4zm3.5 1.2c0-.2-.2-.4-.4-.4h-3.1c-.2 0-.4.2-.4.4s.2.4.4.4h3.1c.2.1.4-.1.4-.4zm-1.5-8.4l-1.7 1.4c-.2.1-.2.4 0 .6s.4.2.6 0l1.4-1.2 1.4 1.2c.2.1.4.1.6 0s.1-.4 0-.6l-1.7-1.4c-.3-.1-.5-.1-.6 0zm7.8 6.2c.1.1.1.2.1.3v7.9c0 .8-.7 1.5-1.5 1.5h-12.5c-.8 0-1.5-.7-1.5-1.5v-7.9c0-.1.1-.2.1-.3l1.6-1.3c.2-.1.4-.1.6 0s.1.4 0 .6l-1.2 1 1.8 1.3v-4c0-.6.5-1.1 1.1-1.1h7.5c.6 0 1.1.5 1.1 1.1v4l1.8-1.3-1.2-1c-.2-.1-.2-.4 0-.6s.4-.2.6 0l1.6 1.3zm-11.6 2.2l4 2.8 4-2.8V7.6c0-.1-.1-.2-.2-.2h-7.5c-.1 0-.2.1-.2.2v4.6zm10.9-1l-4.7 3.4 3.4 2.6c.2.1.2.4.1.6-.1.2-.4.2-.6.1l-3.6-2.8-1.2.8c-.1.1-.3.1-.5 0l-1.2-.8-3.6 2.8c-.2.1-.4.1-.6-.1-.1-.2-.1-.4.1-.6l3.4-2.6-4.7-3.4v7.1c0 .4.3.6.6.6h12.5c.4 0 .6-.3.6-.6v-7.1z"/></svg></span>
        <span class="label">Email</span>
      </a>
    </li>
  

  
  
    <li><a href="https://www.facebook.com/sparklers2018">
  <span class="icon icon--facebook"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M15.117 0H.883C.395 0 0 .395 0 .883v14.234c0 .488.395.883.883.883h7.663V9.804H6.46V7.39h2.086V5.607c0-2.066 1.262-3.19 3.106-3.19.883 0 1.642.064 1.863.094v2.16h-1.28c-1 0-1.195.48-1.195 1.18v1.54h2.39l-.31 2.42h-2.08V16h4.077c.488 0 .883-.395.883-.883V.883C16 .395 15.605 0 15.117 0" fill-rule="nonzero"/></svg></span>
  <span class="label">Facebook</span>
</a>
</li>
  


<!--<div class="subscriptionbox">
  <h2>Subscribe Us</h2>
Get our newsletters right into your inbox by subscribing us.
<form action="https://feedburner.google.com/fb/a/mailverify" id="feedform" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=SparklersweAreTheMakers', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
<input gtbfieldid="3" class="betextarea" name="email" onblur="if (this.value == &quot;&quot;) {this.value = &quot;Enter email address here&quot;;}" onfocus="if (this.value == &quot;Enter email address here&quot;) {this.value = &quot;&quot;;}" value="Enter email address here" type="text">
<input type="hidden" value="SparklersweAreTheMakers" name="uri"><input type="hidden" name="loc" value="en_US">
<input class="besubmit" value="Submit" type="submit">
</form>
</div>-->


</ul>

      </div>
    </div>

    <div class="canvas">
      <div class="wrapper">
        

<header id="masthead">
  <div class="inner">
    <div class="title-area">
      
        <p class="site-title">
          <a href="/blog/">
            <img src="/blog/assets/icons/logo.jpg" alt="" class="site-logo">
            <span>SPARKLERS:We Are The Makers</span>
          </a>
        </p>
      
    </div>
  </div>
</header>

        <div class="initial-content">
          <header class="intro">
  
    
    
    
    <div class="intro-image">
      <img src="/blog/img/sudo/sudo1.jpg" alt="How To Make : A Machine Learning Based Sudoku Solving Robot">
    </div>
  

  <div class="inner">
    <div class="intro-text">
      <h1 id="page-title" class="intro-title">How To Make : A Machine Learning Based Sudoku Solving Robot
</h1>
      

      
        

        <p class="entry-meta">
          <span class="byline-item">by Arijit Das</span><span class="byline-item"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="379 72 16 16"><g><g><path fill="none" d="M380.8,86.7h12.3v-8.8h-12.3V86.7z M389.5,78.8h1.7v1.4h-1.7V78.8z M389.5,81.3h1.7v1.4h-1.7V81.3z M389.5,83.8h1.7v1.4h-1.7V83.8z M386.1,78.8h1.7v1.4h-1.7V78.8z M386.1,81.3h1.7v1.4h-1.7V81.3z M386.1,83.8h1.7v1.4h-1.7V83.8z M382.8,78.8h1.7v1.4h-1.7V78.8z M382.8,81.3h1.7v1.4h-1.7V81.3z M382.8,83.8h1.7v1.4h-1.7V83.8z"/><polygon fill="none" points="384.7 75.1 383.4 75.1 383.4 74.3 380.8 74.3 380.8 76.6 393.2 76.6 393.2 74.3 390.6 74.3 390.6 75.1 389.3 75.1 389.3 74.3 384.7 74.3"/><rect x="382.8" y="78.8" width="1.7" height="1.4"/><rect x="386.1" y="78.8" width="1.7" height="1.4"/><rect x="389.5" y="78.8" width="1.7" height="1.4"/><rect x="382.8" y="81.3" width="1.7" height="1.4"/><rect x="386.1" y="81.3" width="1.7" height="1.4"/><rect x="389.5" y="81.3" width="1.7" height="1.4"/><rect x="382.8" y="83.8" width="1.7" height="1.4"/><rect x="386.1" y="83.8" width="1.7" height="1.4"/><rect x="389.5" y="83.8" width="1.7" height="1.4"/><path d="M383.4,72v1.1h-3.8V88h14.9V73.1h-3.8V72h-1.3v1.1h-4.7V72H383.4z M393.2,86.7h-12.3v-8.8h12.3L393.2,86.7L393.2,86.7z M389.3,74.3v0.8h1.3v-0.8h2.5v2.3h-12.3v-2.3h2.5v0.8h1.3v-0.8H389.3z"/></g></g></svg></span><time datetime="2019-06-30T00:00:00+05:30">June 30, 2019</time></span> <span class="byline-item"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="15 309.7 16 16"><g><path d="M23.9 315.1v3.6c0 .5-.4.9-.9.9s-.9-.4-.9-.9v-3.6h1.8z"/><path d="M30.1 317.7c.5 3.9-2.3 7.5-6.2 7.9-3.9.5-7.5-2.3-7.9-6.2-.5-3.9 2.3-7.5 6.2-7.9v-1.8H24v1.8c1.1.1 2.7.7 3.5 1.4l1.3-1.3 1.3 1.3-1.3 1.3c.5.9 1.2 2.5 1.3 3.5zm-1.8.9c0-2.9-2.4-5.3-5.3-5.3s-5.3 2.4-5.3 5.3 2.4 5.3 5.3 5.3 5.3-2.3 5.3-5.3z"/></g></svg></span>19 min read</span>
        </p>
      

      

      
    </div>
  </div>
</header>


<main id="main" class="page-content" aria-label="Content">
  <div class="inner">
    <article class="entry-wrap">
      <div class="entry-content">
        <div class="embed-responsive embed-responsive-16by9">
  <iframe width="640" height="360" src="https://www.youtube-nocookie.com/embed/68ClHuLKP10?" frameborder="0" allowfullscreen=""></iframe>
</div>

<h2 id="attention-before-you-start-reading-this-article-please-watch-the-above-video-once-as-it-is-how-the-final-model-will-work">!!Attention: Before you start reading this article, please watch the above video once as it is how the final model will work.</h2>
<p>Solving Sudoku is not a very easy job for everyone. It may take a few hours for a beginner to solve a simple sudoku puzzle. That’s why we thought if it’s possible to make a robot which can solve any sudoku puzzle(does not matter how much hard it is) by just seeing it just like a normal human. Here we will see how we can make a simple sudoku solver robot which can solve any sudoku puzzle for us within a very few seconds.</p>

<h2 id="rules-of-sudoku">Rules Of Sudoku:</h2>

<p>So before we make our own robot to solve sudoku, lets review the rules of sudoku:
Sudoku is played on a grid of 9 x 9 spaces. Within the rows and columns are 9 “squares” (made up of 3 x 3 spaces). Each row, column and square (9 spaces each) needs to be filled out with the numbers 1-9, without repeating any numbers within the row, column or square. For example:</p>

<p><img src="http://localhost:4000/blog/img//sudo//sudoku.png" alt="center-aligned-image" class="align-center" /></p>

<p>In the above image, it’s a solved soduko puzzle. As you can see numbers 1-9 are not repeating within any row, column or square.</p>

<h2 id="problem-statement">Problem Statement:</h2>

<p>Before solving any problem, we must understand the problem and its input-output. In this case, our input will be an image of a sudoku puzzle printed in any white paper which will be captured by our robot. It can be an image of a newspaper which consists of a sudoku puzzle. For eaxmple:
<img src="http://localhost:4000/blog/img/sudo/unsolved.jpg" class="align-center" alt="" width="300" height="300" /></p>

<p>The ouput will be the solved puzzle which will be shown in the screen of our robot.
<img src="http://localhost:4000/blog/img/sudo/solved.png" class="align-center" alt="" width="300" height="300" /></p>

<h2 id="required-components">Required Components:</h2>

<p>Now at first, we need to design the hardware for the robot. Basically, we need a microprocessor with at least 512 MB ram, a camera module which supports that microprocessor, a screen, and few other accessories. Here we are using the following hardware parts:</p>
<ol>
  <li>Raspberry pi 3 B+
<img src="http://localhost:4000/blog/img//sudo//rpi.jpg" alt="center-aligned-image" class="align-center" /></li>
  <li>Raspberry Pi Camera Module V2
<img src="http://localhost:4000/blog/img/sudo/camera.jpg" class="align-center" alt="" width="300" height="300" /></li>
  <li>Raspberry pi Touch Screen Module
<img src="http://localhost:4000/blog/img/sudo/screen.png" class="align-center" alt="" width="300" height="300" /></li>
  <li>speaker (small in size)
<img src="http://localhost:4000/blog/img/sudo/speaker.jpg" class="align-center" alt="" width="300" height="300" /></li>
  <li>Led lights
<img src="http://localhost:4000/blog/img/sudo/led.jpg" class="align-center" alt="" width="300" height="300" /></li>
  <li>power supply (2 Amp)
<img src="http://localhost:4000/blog/img/sudo/power.jpg" class="align-center" alt="" width="300" height="300" /></li>
</ol>

<h2 id="connecting-the-components">Connecting the Components:</h2>

<p>Now to make our hardware ready for programming, we just need to follow the following steps:</p>
<ol>
  <li>Install the lastest Rasbian OS in a memory card. For details visit <a href="https://www.raspberrypi.org/documentation/installation/installing-images/">www.raspberrypi.org/documentation/installation/installing-images/</a>.</li>
  <li>Insert the memory card into raspberry pi.</li>
  <li>Connect the raspberry pi with the camera module.
<img src="http://localhost:4000/blog/img/sudo/picam.jpg" class="align-center" alt="" width="300" height="300" /></li>
  <li>Connect the speaker through the audio output jack.
<img src="http://localhost:4000/blog/img/sudo/pispeaker.jpg" class="align-center" alt="" width="300" height="300" /></li>
  <li>connect the LEDS with any of the GPIO pins of raspberry pi.
<img src="http://localhost:4000/blog/img/sudo/piled.png" class="align-center" alt="" width="300" height="300" /></li>
  <li>Conncet the touch screen with raspberry pi.
<img src="http://localhost:4000/blog/img/sudo/piscreen.jpg" class="align-center" alt="" width="300" height="300" /></li>
  <li>Power the pi through the adapter.</li>
</ol>

<h2 id="set-up-raspberry-pi-for-coding">Set Up Raspberry Pi for Coding:</h2>

<p>Now for programming, we can connect the raspberry pi with a large screen through HDMI, or we can simply use SSH. Before doing any further things, first we need to install the required drivers for the raspberry pi screen (details will be available in the “Touch screen” manual). Also, we need to set up the wifi and other settings.</p>

<h2 id="finding-a-suitable-body">Finding a Suitable Body:</h2>

<p>Finally we need to put all these components in a single body so that it looks nice. You may 3D print a custom robot body or may search for any ready-made one. Here I have used a broken toy for this purpose. And the end result looks like this:</p>

<p><img src="http://localhost:4000/blog/img/sudo/sudo.jpg" class="align-center" alt="" width="300" height="380" /></p>

<p>Finally our hardware part is ready and now we can go for the coding part.</p>

<h2 id="solving-the-sudoku">Solving the Sudoku:</h2>

<p>Now our robot needs some kind of algorithm to solve sudoku puzzles. Here we will use backtracking as it is very much efficient for this kind of applications. Now a simple backtracking algorithm to solve a sudoku looks like this:</p>
<pre><code class="language-algorithm">Find row, col of an unassigned cell
  If there is none, return true
  For digits from 1 to 9
    a) If there is no conflict for digit at row, col
        assign digit to row, col and recursively try fill in rest of grid
    b) If recursion successful, return true
    c) Else, remove digit and try another
  If all digits have been tried and nothing worked, return false
							source: Geeksforgeeks
</code></pre>
<p>One can easily implement this algorithm in any programming language. We have used python 2.7 in this case. The code is shown below:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">solver</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">grid</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">digits</span> <span class="o">=</span> <span class="s">'123456789'</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="s">'ABCDEFGHI'</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">digits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">squares</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unitlist</span> <span class="o">=</span> <span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span> <span class="o">+</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span> <span class="k">for</span> <span class="n">rs</span> <span class="ow">in</span> <span class="p">(</span><span class="s">'ABC'</span><span class="p">,</span> <span class="s">'DEF'</span><span class="p">,</span> <span class="s">'GHI'</span><span class="p">)</span> <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="p">(</span><span class="s">'123'</span><span class="p">,</span> <span class="s">'456'</span><span class="p">,</span> <span class="s">'789'</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitlist</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">u</span><span class="p">])</span>
                     <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="p">[]))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">s</span><span class="p">]))</span>
                     <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">=</span><span class="s">""</span>
    <span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
        <span class="s">"Cross product of elements in A and elements in B."</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">A</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="p">]</span>



    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"A set of unit tests."</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">)</span> <span class="o">==</span> <span class="mi">81</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unitlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">27</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peers</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">==</span> <span class="mi">20</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s">'C2'</span><span class="p">]</span> <span class="o">==</span> <span class="p">[[</span><span class="s">'A2'</span><span class="p">,</span> <span class="s">'B2'</span><span class="p">,</span> <span class="s">'C2'</span><span class="p">,</span> <span class="s">'D2'</span><span class="p">,</span> <span class="s">'E2'</span><span class="p">,</span> <span class="s">'F2'</span><span class="p">,</span> <span class="s">'G2'</span><span class="p">,</span> <span class="s">'H2'</span><span class="p">,</span> <span class="s">'I2'</span><span class="p">],</span>
                               <span class="p">[</span><span class="s">'C1'</span><span class="p">,</span> <span class="s">'C2'</span><span class="p">,</span> <span class="s">'C3'</span><span class="p">,</span> <span class="s">'C4'</span><span class="p">,</span> <span class="s">'C5'</span><span class="p">,</span> <span class="s">'C6'</span><span class="p">,</span> <span class="s">'C7'</span><span class="p">,</span> <span class="s">'C8'</span><span class="p">,</span> <span class="s">'C9'</span><span class="p">],</span>
                               <span class="p">[</span><span class="s">'A1'</span><span class="p">,</span> <span class="s">'A2'</span><span class="p">,</span> <span class="s">'A3'</span><span class="p">,</span> <span class="s">'B1'</span><span class="p">,</span> <span class="s">'B2'</span><span class="p">,</span> <span class="s">'B3'</span><span class="p">,</span> <span class="s">'C1'</span><span class="p">,</span> <span class="s">'C2'</span><span class="p">,</span> <span class="s">'C3'</span><span class="p">]]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span><span class="p">[</span><span class="s">'C2'</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="s">'A2'</span><span class="p">,</span> <span class="s">'B2'</span><span class="p">,</span> <span class="s">'D2'</span><span class="p">,</span> <span class="s">'E2'</span><span class="p">,</span> <span class="s">'F2'</span><span class="p">,</span> <span class="s">'G2'</span><span class="p">,</span> <span class="s">'H2'</span><span class="p">,</span> <span class="s">'I2'</span><span class="p">,</span>
                                   <span class="s">'C1'</span><span class="p">,</span> <span class="s">'C3'</span><span class="p">,</span> <span class="s">'C4'</span><span class="p">,</span> <span class="s">'C5'</span><span class="p">,</span> <span class="s">'C6'</span><span class="p">,</span> <span class="s">'C7'</span><span class="p">,</span> <span class="s">'C8'</span><span class="p">,</span> <span class="s">'C9'</span><span class="p">,</span>
                                   <span class="s">'A1'</span><span class="p">,</span> <span class="s">'A3'</span><span class="p">,</span> <span class="s">'B1'</span><span class="p">,</span> <span class="s">'B3'</span><span class="p">])</span>
        <span class="k">print</span> <span class="s">'All tests pass.'</span>


    <span class="k">def</span> <span class="nf">parse_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Convert grid to a dict of possible values, {square: digits}, or
        return False if a contradiction is detected."""</span>
        <span class="c">## To start, every square can be any digit; then assign values from the grid.</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_values</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">digits</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span> <span class="c">## (Fail if we can't assign d to square s.)</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">grid_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"Convert grid into a dict of {square: char} with '0' or '.' for empties."</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">digits</span> <span class="ow">or</span> <span class="n">c</span> <span class="ow">in</span> <span class="s">'0.'</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">81</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">,</span> <span class="n">chars</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="s">"""Eliminate all the other values (except d) from values[s] and propagate.
        Return values, except return False if a contradiction is detected."""</span>
        <span class="n">other_values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eliminate</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span> <span class="k">for</span> <span class="n">d2</span> <span class="ow">in</span> <span class="n">other_values</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">eliminate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="s">"""Eliminate d from values[s]; propagate when values or places &lt;= 2.
        Return values, except return False if a contradiction is detected."""</span>
        <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">values</span> <span class="c">## Already eliminated</span>
        <span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="s">''</span><span class="p">)</span>
        <span class="c">## (1) If a square s is reduced to one value d2, then eliminate d2 from the peers.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span> <span class="c">## Contradiction: removed last value</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">d2</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eliminate</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span> <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span><span class="p">[</span><span class="n">s</span><span class="p">]):</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="c">## (2) If a unit u is reduced to only one place for a value d, then put it there.</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
            <span class="n">dplaces</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">u</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dplaces</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span> <span class="c">## Contradiction: no place for this value</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">dplaces</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c"># d can only be in one place in unit; assign it there</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dplaces</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        <span class="s">"Display these values as a 2-D grid."</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">=</span><span class="s">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s">'+'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">'-'</span><span class="o">*</span><span class="p">(</span><span class="n">width</span><span class="o">*</span><span class="mi">3</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s">'|'</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="s">'36'</span> <span class="k">else</span> <span class="s">''</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="s">'CF'</span><span class="p">:</span> <span class="k">print</span> <span class="n">line</span>
        <span class="k">print</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_grid</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        <span class="s">"Using depth-first search and propagation, try all possible values."</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span> <span class="c">## Failed earlier</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">values</span> <span class="c">## Solved!</span>
        <span class="c">## Chose the unfilled square s with the fewest possibilities</span>
        <span class="n">n</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">]),</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">squares</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">some</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">some</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seq</span><span class="p">):</span>
        <span class="s">"Return some element of seq that is true."</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">:</span> <span class="k">return</span> <span class="n">e</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
	<span class="n">sequence</span> <span class="o">=</span> <span class="s">"530070000600195000098000060800060003400803001700020006060000280000419005000080079"</span>
	<span class="n">s</span><span class="o">=</span><span class="n">solver</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span> <span class="n">main</span><span class="p">()</span>

</code></pre></div></div>

<p>I am not going to explain the code as it will take a lot of time. But let’s see how to use this code. So if we have a puzzle like this:</p>

<p><img src="http://localhost:4000/blog/img/sudo/sudoku1.png" class="align-center" alt="" width="300" height="300" /></p>

<p>We have to write the digits row wise from left to right in sequence. For blanks we have to write ‘0’ in the sequence. So in this case the sequence will be</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sequence</span> <span class="o">=</span> <span class="s">"530070000600195000098000060800060003400803001700020006060000280000419005000080079"</span>
</code></pre></div></div>

<p>After this if we execute the program the output will be:</p>

<pre><code class="language-algorithm">5 3 4 |6 7 8 |9 1 2 
6 7 2 |1 9 5 |3 4 8 
1 9 8 |3 4 2 |5 6 7 
------+------+------
8 5 9 |7 6 1 |4 2 3 
4 2 6 |8 5 3 |7 9 1 
7 1 3 |9 2 4 |8 5 6 
------+------+------
9 6 1 |5 3 7 |2 8 4 
2 8 7 |4 1 9 |6 3 5 
3 4 5 |2 8 6 |1 7 9 
</code></pre>
<p>As we can see it has solved the sudoku perfectly.</p>

<p><strong>credits</strong> : This code is an reimplementation based on the code “Solving Every Sudoku Puzzle” written by Peter Norvig (Director of research at Google). You can visit his site here <a href="https://norvig.com/sudoku.html">norvig.com</a>. For the explaination of this code you can visit <a href="https://towardsdatascience.com/peter-norvigs-sudoku-solver-25779bb349ce">towardsdatascience.com/peter-norvigs-sudoku-solver-25779bb349ce</a>.</p>

<h2 id="recognizing-the-sudoku">Recognizing the Sudoku:</h2>

<p>Now our robot knows how to solve a sudoku puzzle, but it needs the input. Here comes the little tricky part. It needs to scan an image of a Sudoku puzzle and get the input from that. To do so, we need the help of image processing and machine learning. We will process the captured image and recognize digits from it in a particular sequence. Then we will pass the sequence to the previous sudoku solving program and will get the final output.</p>

<p>Here you can find a very basic tutorial for the image processing part <a href="http://opencvpython.blogspot.com/2012/06/sudoku-solver-part-1.html">opencvpython</a>.</p>

<p>A special thanks to Mike Deffenbaugh. He has improved that previous code and got it to work pretty well. You can visit his blog here <a href="http://www.mikedeff.in/sudoku.html">www.mikedeff.in/sudoku.html</a></p>

<p>But in our case, we need a code for our robot. So all these codes will not work as they were not written for the raspberry pi. So I have modified the code for raspberry pi. Actually, I was in a little hurry, so may be there were some parts of the code which can be much better. So I am leaving that part up to you people. And I also hope that someone will improve the accuracy of this image recognizing part as it can be improved. Here I am writing the modified code for raspberry pi:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span> <span class="k">as</span> <span class="n">rn</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">picamera.array</span> <span class="kn">import</span> <span class="n">PiRGBArray</span>
<span class="kn">from</span> <span class="nn">picamera</span> <span class="kn">import</span> <span class="n">PiCamera</span>
<span class="kn">from</span> <span class="nn">sudoku_solve</span> <span class="kn">import</span> <span class="n">solver</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">led</span>

<span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="n">current</span><span class="p">):</span>
   <span class="n">p</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">81</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
               <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">"espeak  -w out.wav {0} &amp;&amp; aplay out.wav"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">puzzleStatusClass</span><span class="p">:</span>
    <span class="c"># this class defines the actual mathematical properties of the sudoku puzzle</span>
    <span class="c"># and the associated methods used to solve the actual sudoku puzzle</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># .current is a 9x9 grid of all solved values for the puzzle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentBackup</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="c"># .last is used to compare to .current to evaluate whether two consecutive OCR results match</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="c"># .orig is used to store the state of .current that is obtained from OCR,</span>
        <span class="c"># but before solving for any new values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="c"># .solve starts off by containing 1-9 in a 9 by 9 grid,</span>
        <span class="c"># by process of elimination .solve will produce the final solution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solveBackup</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># .change is True when the solver algorithm has made a change to .solve</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c"># .guess is True when the solver has given up on analytical techniques</span>
        <span class="c"># and has begun randomly guessing at the solution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guess</span> <span class="o">=</span> <span class="bp">False</span>



    <span class="k">def</span> <span class="nf">checkSolution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># check puzzle using three main rules</span>
        <span class="n">err</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># error code</span>
        <span class="c"># 1) no number shall appear more than once in a row</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>  <span class="c"># for each row</span>
            <span class="c"># count how many of each number exists</span>
            <span class="n">check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="p">:])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">check</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">err</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># incomplete, when the puzzle is complete no zeros should exist</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c"># incorrect, there can't be more than one of any number</span>
                        <span class="k">print</span> <span class="s">"ERROR in row "</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">" with "</span><span class="p">,</span> <span class="n">i</span>
                        <span class="k">return</span> <span class="n">err</span>
        <span class="c"># 2) no number shall appear more than once in a column</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>  <span class="c"># for each column</span>
            <span class="n">check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="p">[:,</span> <span class="n">y</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">check</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">err</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># incomplete</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c"># incorrect</span>
                        <span class="k">print</span> <span class="s">"ERROR in col "</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">" with "</span><span class="p">,</span> <span class="n">i</span>
                        <span class="k">return</span> <span class="n">err</span>
        <span class="c"># 3) no number shall appear more than once in a 3x3 cell</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">3</span><span class="p">:</span><span class="n">x</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="mi">3</span><span class="p">:</span><span class="n">y</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">check</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">err</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># incomplete</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">check</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c"># incorrect</span>
                            <span class="k">print</span> <span class="s">"ERROR in box "</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">" with "</span><span class="p">,</span> <span class="n">i</span>
                            <span class="k">return</span> <span class="n">err</span>
        <span class="k">return</span> <span class="n">err</span>



<span class="k">class</span> <span class="nc">imageClass</span><span class="p">:</span>
    <span class="c">#this class defines all of the important image matrices, and information about the images.</span>
    <span class="c">#also the methods associated with capturing input, displaying the output,</span>
    <span class="c">#and warping and transforming any of the images to assist with OCR</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#.captured is the initially captured image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">captured</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#.gray is the grayscale captured image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gray</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#.thres is after adaptive thresholding is applied</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#.contours contains information about the contours found in the image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contours</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#.biggest contains a set of four coordinate points describing the</span>
        <span class="c">#contours of the biggest rectangular contour found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biggest</span> <span class="o">=</span> <span class="bp">None</span><span class="p">;</span>
        <span class="c">#.maxArea is the area of this biggest rectangular found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxArea</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#.output is an image resulting from the warp() method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputBackup</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputGray</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#.mat is a matrix of 100 points found using a simple gridding algorithm</span>
        <span class="c">#based on the four corner points from .biggest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="c">#.reshape is a reshaping of .mat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reshape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">captureImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">status</span><span class="p">):</span>
        <span class="c">#captures the image and finds the biggest rectangle</span>
	<span class="n">camera</span> <span class="o">=</span> <span class="n">PiCamera</span><span class="p">()</span>
	<span class="n">camera</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
	<span class="n">camera</span><span class="o">.</span><span class="n">framerate</span> <span class="o">=</span> <span class="mi">32</span>
	<span class="n">rawCapture</span> <span class="o">=</span> <span class="n">PiRGBArray</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
 
<span class="c"># allow the camera to warmup</span>
	<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
	<span class="c">#try:</span>
	<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">camera</span><span class="o">.</span><span class="n">capture_continuous</span><span class="p">(</span><span class="n">rawCapture</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">"bgr"</span><span class="p">,</span> <span class="n">use_video_port</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
            <span class="c">#rgb, _ = freenect.sync_get_video()</span>
            <span class="c">#cv2.namedWindow("SUDOKU Solver")</span>
            <span class="c">#vc = cv2.VideoCapture(1)</span>
            <span class="c">#if vc.isOpened():  # try to get the first frame</span>
             <span class="c">#   rval, rgb = vc.read()</span>
            <span class="c">#else:</span>
             <span class="c">#   rval = False</span>
            <span class="c">#bgr = cv2.cvtColor(rgb, cv2.COLOR_BGR2R</span>
		<span class="n">image</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">array</span>
		<span class="c">#cv2.imshow("Frame", image)</span>
		<span class="c">#key = cv2.waitKey(1) &amp; 0xFF</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">captured</span> <span class="o">=</span> <span class="n">image</span>
		<span class="n">rawCapture</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c">#except TypeError:</span>
            <span class="c">#print "No Kinect Detected!"</span>
            <span class="c">#print "Loading sudoku.jpg..."</span>
            <span class="c"># for testing purposes</span>
            <span class="c">#img = cv2.imread("sudoku_test3.png")</span>
            <span class="c">#self.captured = cv2.resize(img, (600, 600))</span>

		<span class="c"># convert to grayscale</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
		<span class="k">print</span> <span class="s">"gray"</span>
		<span class="c"># noise removal with gaussian blur</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
		<span class="c"># then do adaptive thresholding</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

		<span class="c"># find countours in threshold image</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresh</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)</span>

		<span class="c"># evaluate all blobs to find blob with biggest area</span>
		<span class="c"># biggest rectangle in the image must be sudoku square</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">biggest</span> <span class="o">=</span> <span class="bp">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">maxArea</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
		    <span class="n">area</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
		    <span class="k">if</span> <span class="n">area</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>  <span class="c"># 50000 is an estimated value for the kind of blob we want to evaluate</span>
		        <span class="n">peri</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">arcLength</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>   <span class="c">#return the perimeter of the contour</span>
		        <span class="n">approx</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">approxPolyDP</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">peri</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
		        <span class="k">if</span> <span class="n">area</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxArea</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">approx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
		            <span class="bp">self</span><span class="o">.</span><span class="n">biggest</span> <span class="o">=</span> <span class="n">approx</span>
		            <span class="bp">self</span><span class="o">.</span><span class="n">maxArea</span> <span class="o">=</span> <span class="n">area</span>
		            <span class="n">best_cont</span> <span class="o">=</span> <span class="n">i</span>
	        <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">detect</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
                   <span class="n">led</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">detect</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
		    <span class="n">status</span><span class="o">.</span><span class="n">puzzleFound</span> <span class="o">=</span> <span class="bp">True</span>
		    <span class="k">print</span> <span class="s">"Sudoku puzzle detected!"</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxArea</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
		    <span class="n">status</span><span class="o">.</span><span class="n">noDetect</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># reset</span>
		    <span class="n">status</span><span class="o">.</span><span class="n">detect</span> <span class="o">+=</span> <span class="mi">1</span>
		    <span class="c"># draw self.biggest approx contour</span>
		    <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">completed</span><span class="p">:</span>
		        <span class="n">cv2</span><span class="o">.</span><span class="n">polylines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
		    <span class="k">elif</span> <span class="n">status</span><span class="o">.</span><span class="n">puzzleFound</span><span class="p">:</span>
		        <span class="n">cv2</span><span class="o">.</span><span class="n">polylines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
		    <span class="k">else</span><span class="p">:</span>
		        <span class="n">cv2</span><span class="o">.</span><span class="n">polylines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
		    <span class="bp">self</span><span class="o">.</span><span class="n">reorder</span><span class="p">()</span>  <span class="c"># reorder self.biggest</span>
		<span class="k">else</span><span class="p">:</span>
		    <span class="n">status</span><span class="o">.</span><span class="n">noDetect</span> <span class="o">+=</span> <span class="mi">1</span>
		    <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">noDetect</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
                        <span class="n">led</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
		        <span class="k">print</span> <span class="s">"No sudoku puzzle detected!"</span>
		    <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">noDetect</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
		        <span class="c">#status.restart = True</span>
			<span class="k">pass</span>
		<span class="s">"""if status.detect == 25:
		    status.puzzleFound = True
		    print "Sudoku puzzle detected!"""</span>
		<span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">beginSolver</span> <span class="o">==</span> <span class="bp">False</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxArea</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
		    <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">'sudoku'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">)</span>
		    <span class="n">key</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
		    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
		        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">puzzleFound</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
			<span class="n">camera</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="k">break</span>
		

            
    <span class="k">def</span> <span class="nf">reorder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#reorders the points obtained from finding the biggest rectangle</span>
        <span class="c">#[top-left, top-right, bottom-right, bottom-left]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
     
        <span class="n">add</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">add</span><span class="p">)]</span> <span class="c">#smallest sum</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">add</span><span class="p">)]</span> <span class="c">#largest sum</span>
             
        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c">#y-x</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">diff</span><span class="p">)]</span> <span class="c">#min diff</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">diff</span><span class="p">)]</span> <span class="c">#max diff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biggest</span> <span class="o">=</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">perspective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#create 100 points using "biggest" and simple gridding algorithm,</span>
        <span class="c">#these 100 points define the grid of the sudoku puzzle</span>
        <span class="c">#topLeft-topRight-bottomRight-bottomLeft = "biggest"</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">c_sqrt</span><span class="o">=</span><span class="mi">10</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="o">.</span><span class="nb">any</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">biggest</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">640</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">480</span><span class="p">]]</span>
        <span class="n">tl</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">br</span><span class="p">,</span><span class="n">bl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">biggest</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="o">%</span><span class="n">c_sqrt</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">c_sqrt</span>
            <span class="n">ml</span> <span class="o">=</span> <span class="p">[</span><span class="n">tl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">bl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">tl</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">j</span><span class="p">,</span><span class="n">tl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">bl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">j</span><span class="p">]</span>
            <span class="n">mr</span> <span class="o">=</span> <span class="p">[</span><span class="n">tr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">br</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">tr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">j</span><span class="p">,</span><span class="n">tr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">br</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">j</span><span class="p">]</span>
<span class="c">##            self.mat[k,0] = ml[0]+(mr[0]-ml[0])/9*i</span>
<span class="c">##            self.mat[k,1] = ml[1]+(mr[1]-ml[1])/9*i</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">itemset</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">ml</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">mr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ml</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">itemset</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ml</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">mr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ml</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reshape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">c_sqrt</span><span class="p">,</span><span class="n">c_sqrt</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">warp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#take distorted image and warp to flat square for clear OCR reading</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">gray</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
        <span class="n">close</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CLOSE</span><span class="p">,</span><span class="n">kernel</span><span class="p">)</span>
        <span class="n">division</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">close</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">division</span><span class="p">,</span><span class="n">division</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">NORM_MINMAX</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_GRAY2BGR</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">450</span><span class="p">,</span><span class="mi">450</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">c_sqrt</span><span class="o">=</span><span class="mi">10</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">):</span>
            <span class="n">ri</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="n">c_sqrt</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">i</span><span class="o">%</span><span class="n">c_sqrt</span>
            <span class="k">if</span> <span class="n">ci</span> <span class="o">!=</span> <span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">ri</span> <span class="o">!=</span> <span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape</span><span class="p">[</span><span class="n">ri</span><span class="p">:</span><span class="n">ri</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">ci</span><span class="p">:</span><span class="n">ci</span><span class="o">+</span><span class="mi">2</span> <span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">dest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span><span class="n">ci</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">ri</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)],[(</span><span class="n">ci</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                            <span class="n">ri</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)],[</span><span class="n">ci</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="n">ri</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
                            <span class="p">[(</span><span class="n">ci</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="n">ri</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
                <span class="n">trans</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getPerspectiveTransform</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">dest</span><span class="p">)</span>
                <span class="n">warp</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpPerspective</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">trans</span><span class="p">,(</span><span class="mi">450</span><span class="p">,</span><span class="mi">450</span><span class="p">))</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ri</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">):(</span><span class="n">ri</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">ci</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">):(</span><span class="n">ci</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span>
                       <span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">warp</span><span class="p">[</span><span class="n">ri</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">):(</span><span class="n">ri</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span>
                        <span class="n">ci</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">):(</span><span class="n">ci</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">450</span><span class="o">/</span><span class="p">(</span><span class="n">c_sqrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">output_backup</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">'output'</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputBackup</span> <span class="o">=</span> <span class="n">output_backup</span>

    
    <span class="k">def</span> <span class="nf">virtualImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">puzzle</span><span class="p">,</span><span class="n">status</span><span class="p">):</span>
        <span class="c"># output known sudoku values to the real image</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxArea</span><span class="p">))</span> <span class="o">/</span> <span class="mi">400</span>
        <span class="n">w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">tsize</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">25</span> <span class="o">*</span> <span class="n">tsize</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
            <span class="c">##            x = int(self.mat[i][0]+8*tsize)</span>
            <span class="c">##            y = int(self.mat[i][1]+8*tsize)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">tsize</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">tsize</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">!=</span> <span class="mi">9</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">:</span>
                <span class="n">yc</span> <span class="o">=</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">9</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="n">j</span> <span class="o">/</span> <span class="mi">9</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">original</span><span class="p">[</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">current</span><span class="p">[</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">puzzle</span><span class="o">.</span><span class="n">current</span><span class="p">[</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">])</span>
                    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tsize</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">completed</span><span class="p">:</span>
            <span class="c">#pl=self.path.split('.')</span>
            <span class="c">#name=pl[0]+"_solved."+pl[1]</span>
	    <span class="n">name</span><span class="o">=</span> <span class="s">"solve"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rn</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5000</span><span class="p">))</span><span class="o">+</span><span class="s">".jpg"</span>
	    <span class="k">print</span> <span class="n">name</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">)</span>
            <span class="n">led</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
            <span class="c">#os.system("espeak -g 5 -w out.wav 'I have solved the puzzle' &amp;&amp; aplay out.wav")</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">"mplayer solved.mp3"</span><span class="p">)</span>
	    <span class="c">#t1=threading.Thread(target=speak, args=(puzzle.current,))</span>
            <span class="c">#t1.start()</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">'sudoku'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">captured</span><span class="p">)</span>
        <span class="s">"""p = puzzle.current.reshape(1,81)
        for i in p:
            for j in i:
               os.system("espeak  -w out.wav {0} &amp;&amp; aplay out.wav".format(j))"""</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1000000000</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
           <span class="c">#sys.exit()</span>
	   <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
        <span class="c">#t1.join()</span>
<span class="k">class</span> <span class="nc">OCRmodelClass</span><span class="p">:</span>
    <span class="c">#this class defines the data used for OCR,</span>
    <span class="c">#and the associated methods for performing OCR</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">'generalsamples.data'</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">'generalresponses.data'</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="n">responses</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">responses</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="c">#.model uses kNearest to perform OCR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">KNearest</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="n">responses</span><span class="p">)</span>
        <span class="c">#.iterations contains information on what type of morphology to use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lvl</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">#index of .iterations</span>
        
    <span class="k">def</span> <span class="nf">OCR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">status</span><span class="p">,</span><span class="n">image</span><span class="p">,</span><span class="n">puzzle</span><span class="p">):</span>
        <span class="c">#preprocessing for OCR</span>
        <span class="c">#convert image to grayscale</span>
        <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
        <span class="c">#noise removal with gaussian blur</span>
        <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">gray</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">image</span><span class="o">.</span><span class="n">outputGray</span> <span class="o">=</span> <span class="n">gray</span>
        
        <span class="c">#attempt to read the image with 4 different morphology values and find the best result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">lvl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">:</span>
            <span class="n">image</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">outputBackup</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OCR_read</span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="n">image</span><span class="p">,</span><span class="n">puzzle</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lvl</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lvl</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">checkSolution</span><span class="p">()</span>
        <span class="n">best</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">best</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">best</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">ibest</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">print</span> <span class="s">"success:"</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">success</span>
        <span class="k">print</span> <span class="s">"errors:"</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span>
        
        <span class="k">if</span> <span class="n">best</span><span class="o">==</span><span class="mi">8</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">"ERROR - OCR FAILURE"</span>
            <span class="n">status</span><span class="o">.</span><span class="n">restart</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">"final morph erode iterations:"</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">[</span><span class="n">ibest</span><span class="p">]</span>
            <span class="n">image</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">outputBackup</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lvl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">[</span><span class="n">ibest</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OCR_read</span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="n">image</span><span class="p">,</span><span class="n">puzzle</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">'output'</span><span class="p">,</span><span class="n">image</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">OCR_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">status</span><span class="p">,</span><span class="n">image</span><span class="p">,</span><span class="n">puzzle</span><span class="p">):</span>
        <span class="c">#perform actual OCR using kNearest model</span>
        <span class="n">thresh</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">outputGray</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lvl</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">morph</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">thresh</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ERODE</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">iterations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lvl</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">lvl</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">morph</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">thresh</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_DILATE</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">thresh_copy</span> <span class="o">=</span> <span class="n">morph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c">#thresh2 changes after findContours</span>
        <span class="n">contours</span><span class="p">,</span><span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">morph</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">RETR_LIST</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)</span>
        <span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh_copy</span>

        <span class="n">puzzle</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

        <span class="c"># testing section</span>
        <span class="k">for</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">contours</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">:</span>
                <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
                <span class="k">if</span>  <span class="n">h</span><span class="o">&gt;</span><span class="mi">20</span> <span class="ow">and</span> <span class="n">h</span><span class="o">&lt;</span><span class="mi">40</span> <span class="ow">and</span> <span class="n">w</span><span class="o">&gt;</span><span class="mi">8</span> <span class="ow">and</span> <span class="n">w</span><span class="o">&lt;</span><span class="mi">40</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">w</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">:</span>
                        <span class="n">diff</span> <span class="o">=</span> <span class="mi">20</span><span class="o">-</span><span class="n">w</span>
                        <span class="n">x</span> <span class="o">-=</span> <span class="n">diff</span><span class="o">/</span><span class="mi">2</span>
                        <span class="n">w</span> <span class="o">+=</span> <span class="n">diff</span>
                    <span class="n">sudox</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="mi">50</span>
                    <span class="n">sudoy</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="mi">50</span>
                    <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">output</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
                    <span class="c">#prepare region of interest for OCR kNearest model</span>
                    <span class="n">roi</span> <span class="o">=</span> <span class="n">thresh</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="p">,</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">]</span>
                    <span class="n">roismall</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">roi</span><span class="p">,(</span><span class="mi">25</span><span class="p">,</span><span class="mi">35</span><span class="p">))</span>
                    <span class="n">roismall</span> <span class="o">=</span> <span class="n">roismall</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">875</span><span class="p">))</span>
                    <span class="n">roismall</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">roismall</span><span class="p">)</span>
                    <span class="c">#find result</span>
                    <span class="n">retval</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">neigh_resp</span><span class="p">,</span> <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_nearest</span><span class="p">(</span><span class="n">roismall</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="c">#check for read errors</span>
                    <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])))</span>
                        <span class="k">if</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">current</span><span class="p">[</span><span class="n">sudoy</span><span class="p">,</span><span class="n">sudox</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                            <span class="n">puzzle</span><span class="o">.</span><span class="n">current</span><span class="p">[</span><span class="n">sudoy</span><span class="p">,</span><span class="n">sudox</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lvl</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">2</span> <span class="c">#double read error</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lvl</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">output</span><span class="p">,</span><span class="n">string</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lvl</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">3</span> <span class="c">#read zero error</span>
                    

<span class="k">class</span> <span class="nc">solverStatusClass</span><span class="p">:</span>
    <span class="c">#this class defines the status of the main loop</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#.beginSolver becomes true when the puzzle is completely captured and ready to solve</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beginSolver</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#.puzzleFound becomes true when the puzzle is thought to be found but not yet read with OCR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">puzzleFound</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#.puzzleRead becomes true when OCR has confirmed the puzzle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">puzzleRead</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#.restart becomes true when the main loop needs to restart</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#.completed becomes true when the puzzle has been solved</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#.number of times imageClass.captureImage() detects no puzzle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noDetect</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#.number of times imageClass.captureImage() detects a puzzle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">OCRmodelClass</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">speak</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="c">#try:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">solverStatusClass</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">status</span><span class="o">.</span><span class="n">beginSolver</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="c">#status = solverStatusClass()</span>
            <span class="n">puzzle</span> <span class="o">=</span> <span class="n">puzzleStatusClass</span><span class="p">()</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">imageClass</span><span class="p">()</span>
            <span class="k">print</span> <span class="s">"Waiting for puzzle..."</span>
            <span class="k">while</span> <span class="n">status</span><span class="o">.</span><span class="n">puzzleFound</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">image</span><span class="o">.</span><span class="n">captureImage</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">restart</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">while</span> <span class="n">status</span><span class="o">.</span><span class="n">puzzleRead</span> <span class="o">==</span> <span class="bp">False</span> <span class="ow">and</span> <span class="n">status</span><span class="o">.</span><span class="n">puzzleFound</span> <span class="o">==</span> <span class="bp">True</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">speak</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                   <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">"espeak -g 5 -w out.wav 'I found a puzzle' &amp;&amp; aplay out.wav"</span><span class="p">)</span>
		<span class="n">speak</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
		<span class="k">print</span> <span class="s">"Reading"</span>
                <span class="c">#image.captureImage(status)</span>
                <span class="n">image</span><span class="o">.</span><span class="n">perspective</span><span class="p">()</span>
                <span class="n">image</span><span class="o">.</span><span class="n">warp</span><span class="p">()</span>
                <span class="n">reader</span><span class="o">.</span><span class="n">OCR</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">puzzle</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">restart</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s">"Restarting..."</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">puzzle</span><span class="o">.</span><span class="n">current</span><span class="p">,</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">last</span><span class="p">):</span>
                    <span class="n">status</span><span class="o">.</span><span class="n">beginSolver</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">status</span><span class="o">.</span><span class="n">puzzleRead</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">print</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">current</span>
                    <span class="n">puzzle</span><span class="o">.</span><span class="n">original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">puzzle</span><span class="o">.</span><span class="n">current</span><span class="p">)</span>
                    <span class="c">#image.virtualImage(puzzle)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s">"Rechecking for Puzzle Match..."</span>
                    <span class="n">puzzle</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">puzzle</span><span class="o">.</span><span class="n">current</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">beginSolver</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">"espeak -g 5 -w out.wav 'I have recognised the puzzle and now I am trying to solve it' &amp;&amp; aplay out.wav"</span><span class="p">)</span>
		<span class="k">print</span> <span class="s">"solving start"</span>
	        <span class="n">s</span><span class="o">=</span><span class="n">puzzle</span><span class="o">.</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">81</span><span class="p">)</span>
	        <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">"S"</span><span class="p">)</span>
	        <span class="n">l</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
	        <span class="n">p</span> <span class="o">=</span> <span class="s">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
	
	        <span class="n">sudo_solver</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
	        <span class="n">sudo_solver</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">sudo_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
	        <span class="n">status</span><span class="o">.</span><span class="n">completed</span> <span class="o">=</span> <span class="bp">True</span>
	
	        <span class="n">solved_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">sudo_solver</span><span class="o">.</span><span class="n">seq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span>
	        <span class="n">solved_seq</span><span class="o">=</span><span class="n">solved_seq</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
	        <span class="n">puzzle</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">solved_seq</span><span class="p">)</span>
	        <span class="k">print</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">current</span>
	        <span class="s">"""p = puzzle.current.reshape(1,81)
	        for i in p:
                   for j in i:
                      os.system("espeak  -w out.wav {0} &amp;&amp; aplay out.wav".format(j))"""</span>
	        <span class="n">puzzle</span><span class="o">.</span><span class="n">solve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">solved_seq</span><span class="p">)</span>
	        <span class="c">#image.virtualImage(puzzle)</span>
		<span class="k">print</span> <span class="s">"puzzle solved"</span>
		<span class="s">"""if status.completed:
			cv2.polylines(image.captured, [self.biggest], True, (0, 255, 0), 3)
		elif status.puzzleFound:
			cv2.polylines(image.captured, [self.biggest], True, (0, 255, 255), 3)"""</span>
	
		<span class="n">image</span><span class="o">.</span><span class="n">perspective</span><span class="p">()</span>
		<span class="n">image</span><span class="o">.</span><span class="n">virtualImage</span><span class="p">(</span><span class="n">puzzle</span><span class="p">,</span><span class="n">status</span><span class="p">)</span>
	
	        <span class="c">#image.captureImage(status)</span>
	        <span class="c">#if image.maxArea &gt; 0:</span>
	      	<span class="s">"""except:
	        print "Error occured, restarting....."
		continue"""</span>
  <span class="k">except</span> <span class="nb">AttributeError</span><span class="p">:</span>
      <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">"espeak -g 5 -w out.wav 'I am unable to recognise it ,please show me again' &amp;&amp; aplay out.wav"</span><span class="p">)</span>
	<span class="n">main</span><span class="p">()</span>

  <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
     <span class="n">led</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span> <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>Here you need to install few python libraries and tools:</p>
<ol>
  <li>openCV2 (apt-get install python-opencv)</li>
  <li>picamera</li>
  <li>espeak (apt-get install espeak)</li>
</ol>

<p>Also don’t forget to save the sudoku solver code in the same directory as “sudoku-solve.py”.
You will also need some trained files to run this code. You can find all that here <a href="http://www.mikedeff.in/sudoku.html">www.mikedeff.in/sudoku.html</a>. The credit goes to Mike Deffenbaugh for creating these trained files.</p>
<h2 id="download-all-the-files">Download All The Files:</h2>
<ul>
  <li><a href="http://localhost:4000/blog/img/sudo//generalresponses.data">generalresponses.data</a></li>
  <li><a href="http://localhost:4000/blog/img/sudo//generalsamples.data">generalsamples.data</a></li>
  <li><a href="http://localhost:4000/blog/img/sudo//sudoku-solve.py">sudoku_solve.py</a></li>
  <li><a href="http://localhost:4000/blog/img/sudo//main.py">main.py</a></li>
</ul>

<p>Just download these files and save them in the same folder. Then run the main.py program.</p>

<h2 id="showcasing-our-sudoku-solver">Showcasing Our Sudoku Solver</h2>
<p>So we gave it a name SUDO and showcased it in “Kolkata Mini Makers Faire 2019” (First time in Eastern India). And we got a great appreciation from the audience.</p>
<figure class="align-center">
  <a href="#"><img src="http://localhost:4000/blog/img/sudo/show1.jpg" alt="" width="500" height="500" /></a>
  <figcaption>Showcasing SUDO to few visitors</figcaption>
</figure>
<figure class="align-center">
  <a href="#"><img src="http://localhost:4000/blog/img/sudo/show2.jpg" alt="" width="500" height="500" /></a>
  <figcaption>Giving interview to a newspaper reporter</figcaption>
</figure>
<!---## Like our facebook page so that you won't miss out future updates
Follow us on facebook at : <a href="https://www.facebook.com/sparklers2018">
  <span class="icon icon--facebook"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M15.117 0H.883C.395 0 0 .395 0 .883v14.234c0 .488.395.883.883.883h7.663V9.804H6.46V7.39h2.086V5.607c0-2.066 1.262-3.19 3.106-3.19.883 0 1.642.064 1.863.094v2.16h-1.28c-1 0-1.195.48-1.195 1.18v1.54h2.39l-.31 2.42h-2.08V16h4.077c.488 0 .883-.395.883-.883V.883C16 .395 15.605 0 15.117 0" fill-rule="nonzero"/></svg></span>
  <span class="label">sparklers2018</span>
</a>
-->


      </div>

<div id="share-bar">

    <h4>Share this:</h4>

    <div class="share-buttons">
        <a  href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Facebook" >
            <i class="fa fa-facebook-official share-button"> facebook</i>
        </a>

        <a  href="https://twitter.com/intent/tweet?text=How To Make : A Machine Learning Based Sudoku Solving Robot&url=http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Twitter" >
            <i class="fa fa-twitter share-button"> twitter</i>
        </a>


        <a  href="https://www.pinterest.com/pin/create/button/?url=http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Pinterest" >
            <i class="fa fa-pinterest-p share-button"> pinterest</i>
        </a>


        <a  href="http://www.reddit.com/submit?url=http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Reddit" >
            <i class="fa fa-reddit-alien share-button"> reddit</i>
        </a>

        <a  href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/&title=How To Make : A Machine Learning Based Sudoku Solving Robot&summary=How to make a machine learning based sudoku solver robot using a Raspberry Pi from scratch.&source=SPARKLERS:We Are The Makers"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on LinkedIn" >
            <i class="fa fa-linkedin share-button"> linkedin</i>
        </a>

        <a  href="mailto:?subject=How To Make : A Machine Learning Based Sudoku Solving Robot&amp;body=Check out this site http://localhost:4000/blog/robotics/SUDO-A-Machine-Learning-Based-Sudoku-Solver-Robot/"
            title="Share via Email" >
            <i class="fa fa-envelope share-button"> email</i>
        </a>
    </div>

</div>

<hr>
<h3>The Author :</h3>
<section class="author-box">
  <img src="http://localhost:4000/blog/team/img/team/3.jpg" alt="" class="author-img">
  <div class="author-desc">
    <h2>Arijit Das</h2>
    <p>I am a computer science engineering student. I believe that piece of code is mightier than pen as well as a sword. Programming and Solving problems are my passion and that what I strive to practice for my career.</p>
    <ul>
      
        <li class="email"><a href="mailto:arijit1080@gmail.com"><i class="fa fa-envelope-o"></i></a></li>
      
      
        <li class="phone"><a href="tel:918617219494"><i class="fa fa-phone"></i></a></li>
      
      
        <li class="linkedin"><a href="http://www.linkedin.com/in/arijit-das-1080/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
      
      
        <li class="facebook"><a href="https://www.facebook.com/profile.php?id=100009569555607" target="_blank"><i class="fa fa-facebook"></i></a></li>
      
    </ul>
  </div>
</section>

<hr>
<h2>Like our facebook page so that you won't miss out future updates</h2>
<p>Follow us on facebook at : <a href="https://www.facebook.com/sparklers2018">
  <span class="icon icon--facebook"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M15.117 0H.883C.395 0 0 .395 0 .883v14.234c0 .488.395.883.883.883h7.663V9.804H6.46V7.39h2.086V5.607c0-2.066 1.262-3.19 3.106-3.19.883 0 1.642.064 1.863.094v2.16h-1.28c-1 0-1.195.48-1.195 1.18v1.54h2.39l-.31 2.42h-2.08V16h4.077c.488 0 .883-.395.883-.883V.883C16 .395 15.605 0 15.117 0" fill-rule="nonzero"/></svg></span>
  <span class="label">sparklers2018</span>
</a>
</p>
      <!--
        
      -->
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = sparklers-the-makers.github.io/blog;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = sparklers-the-makers.github.io/blog; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://sparklers-1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </article>
  </div>
</main>

        </div>

        <div class="search-content">
          <div class="inner">
  <label class="visually-hidden" for="search">Site Search</label>
        <input type="text" id="search" class="search-input" aria-describedby="results-count" tabindex="-1" placeholder="Enter your search term..." />
        <div id="results" class="results"></div>
</div>

        </div>
      </div>
    </div>



    
<footer class="main_footer">

<section class="newsletter" id="mc_embed_signup">
  <h2 class="newsletter_title">Newsletter</h2>
  <form action="https://feedburner.google.com/fb/a/mailverify" id="feedform" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=SparklersweAreTheMakers', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
    <label for="mce-EMAIL">Subscribe here to get our latest updates</label>
    <div class="newsletter_box" id="mc_embed_signup_scroll">
      <input type="email" name="email" placeholder="Email address" class="email_input" id="mce-EMAIL" required>
      <input type="hidden" value="SparklersweAreTheMakers" name="uri"><input type="hidden" name="loc" value="en_US">
      <input type="submit" value="Subscribe" name="subscribe" class="subscribe_btn" id="mc-embedded-subscribe">
    </div>
  </form>
</section> <!-- End Section Newsletter -->


    
<ul class="social_footer">
  
  <li><a href="mailto:sparkler988323@gmail.com" target="_blank"><i class="fa fa-google" aria-hidden="true"></i></a></li>      
  
  
  <li><a href="#hook" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
  
  
  <li><a href="#hook" target="_blank"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
  
  
  <li><a href="https://www.facebook.com/sparklers2018/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
  
</ul>

    <div class="copyright">
      <p>&copy; 2019 All rights reserved. Design by <a href="" target="_blank">Sparklers</a></p>
    </div>
</footer> <!-- End Section Footer -->


    

<script async src="/blog/assets/javascripts/main.js"></script>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="http://localhost:4000/blog/assets/javascripts/lunr/lunr.min.js"></script>
  <script src="http://localhost:4000/blog/assets/javascripts/search-data.json"></script>
  <script>
    var idx = lunr(function () {
      
      // the, the normal lunr index initialization
      this.field('title')
      this.field('excerpt')
      this.field('categories')
      this.field('tags')
      this.ref('id')

      this.pipeline.remove(lunr.trimmer)

      // add documents to index
      for (var item in store) {
        this.add({
          title: store[item].title,
          excerpt: store[item].excerpt,
          categories: store[item].categories,
          tags: store[item].tags,
          id: item
        })
      }
    });

    console.log(jQuery.type(idx));

    $(document).ready(function () {
      $('input#search').on('keyup', function () {
        var resultdiv = $('#results');
        var query = $(this).val().toLowerCase();
        var result =
          idx.query(function (q) {
            query.split(lunr.tokenizer.separator).forEach(function (term) {
              q.term(term, { boost: 100 })
              if (query.lastIndexOf(" ") != query.length - 1) {
                q.term(term, { usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
              }
              if (term != "") {
                q.term(term, { usePipeline: false, editDistance: 1, boost: 1 })
              }
            })
          });
        resultdiv.empty();
        resultdiv.prepend('<p id="results-count" class="results-found">' + result.length + ' Result(s) found</p>');
        for (var item in result) {
          var ref = result[item].ref;
          var searchitem =
            '<article class="entry">' +
              '<h3 class="entry-title">' +
                '<a href="' + store[ref].url + '">' + store[ref].title + '</a>' +
              '</h3>' +
              '<div class="entry-excerpt">' +
                '<p>' + store[ref].excerpt.split(" ").splice(0, 20).join(" ") + '...</p>' +
              '</div>' +
            '</article>';
          resultdiv.append(searchitem);
        }
      });
    });
  </script>


    

  </body>

</html>
